<html xmlns="http://www.w3.org/1999/xhtml"><head>
    <meta charset="utf-8" />
    <title>Voxel Dungeon VR</title>
    <script src="js/aframe-master.js"></script>
    <script src="js/handleEvents.js"></script>
    <script src="js/movement.js"></script>
    <script src="js/enemy.js"></script>
    <script src="js/player.js"></script>
    <script src="js/aframe-physics-system.min.js"></script>
    <script src="js/aframe-extras.min.js"></script>
    <script src="https://unpkg.com/aframe-look-at-component@0.5.1/dist/aframe-look-at-component.min.js"></script>
  </head>
  <body class="a-body">
    <a-scene debug="" physics="debug: true" class="fullscreen" canvas="" inspector="" keyboard-shortcuts="" screenshot="" vr-mode-ui="" auto-enter-vr="">
      <a-assets>
        <a-asset-item id="player-sword-obj" src="resources/player_sword.obj" preload="auto"></a-asset-item>
        <a-asset-item id="player-sword-mtl" src="resources/player_sword.mtl" preload="auto"></a-asset-item>
        <a-asset-item id="player-shield-obj" src="resources/player_shield.obj" preload="auto"></a-asset-item>
        <a-asset-item id="player-shield-mtl" src="resources/player_shield.mtl" preload="auto"></a-asset-item>
        <a-asset-item id="shop-obj" src="resources/shop.obj" preload="auto"></a-asset-item>
        <a-asset-item id="shop-head-mtl" src="resources/shop_head.mtl" preload="auto"></a-asset-item>
        <a-asset-item id="shop-head-obj" src="resources/shop_head.obj" preload="auto"></a-asset-item>
        <a-asset-item id="shop-mtl" src="resources/shop.mtl" preload="auto"></a-asset-item>
      	<img id="ghost_img" src="https://ucarecdn.com/f6bf9fe3-82b4-43ba-b5b6-a7e308b64c77/" crossorigin="anonymous">
      	<img id="wall_img" src="https://ucarecdn.com/3336cb05-b8f8-4836-b3f8-91b13e448d0c/" crossorigin="anonymous">
      	<audio id="bg_music" src="resources/bg_music.mp3" preload="auto"></audio>
      	<audio id="fx_punch" src="resources/fx_punch.mp3" preload="auto"></audio>
      	<audio id="fx_teleport" src="resources/fx_teleport.mp3" preload="auto"></audio>

      	<a-mixin id="torch" castShadow="true" static-body geometry="depth:0.3;height:0.3;width:0.3"/>
      	<a-mixin id="torch_light" light="angle:0;decay:0;intensity:2;type:point;color:#ff9328;distance:10;decay:1"/>
      	<a-mixin id="wall" shadow="cast: true" color="grey" material="src:#wall_img;roughness:1;metalness:0.3" static-body/>
      	<a-mixin id="tp_sphere" sound="src:#fx_teleport; poolSize:5; volume:0.2" static-movement geometry="primitive:sphere;radius:0.3" material="color:blue;roughness:1"/>
      </a-assets>

      <!-- BG Music -->
      <a-entity sound="src:#bg_music"></a-entity>

      <!-- Teleport Sound -->
      <a-entity sound="src:#fx_teleport"></a-entity>

      <!-- Teleport System Spheres -->
      <a-entity id="blueTPSphere-1" mixin="tp_sphere" position="1.526 2.884 -2.804"></a-entity>
      <a-entity id="blueTPSphere-2" mixin="tp_sphere" position="1.464 2.884 7.124"></a-entity>
      <a-entity id="blueTPSphere-3" mixin="tp_sphere" position="-3.437 2.884 5.284"></a-entity>
      <a-entity id="blueTPSphere-4" mixin="tp_sphere" position="21.004 2.884 5.341"></a-entity>
      <a-entity id="blueTPSphere-5" mixin="tp_sphere" position="0.401 2.884 22.737"></a-entity>
      <a-entity id="blueTPSphere-6" mixin="tp_sphere" position="1.415 2.884 -12.288"></a-entity>
      <a-entity id="blueTPSphere-7" mixin="tp_sphere" position="-8.264 2.884 -12.288"></a-entity>
      <a-entity id="blueTPSphere-8" mixin="tp_sphere" position="10.55 2.884 -12.288"></a-entity>
      <a-entity id="blueTPSphere-9" mixin="tp_sphere" position="1.415 2.884 -22.316"></a-entity>
      <a-entity id="blueTPSphere-10" mixin="tp_sphere" position="20.92 2.884 -12.217"></a-entity>
      <a-entity id="blueTPSphere-11" mixin="tp_sphere" position="21.027 2.884 22.455"></a-entity>
      <a-entity id="blueTPSphere-12" mixin="tp_sphere" position="1.473 2.884 1.942"></a-entity>
      <a-entity id="blueTPSphere-13" mixin="tp_sphere" position="-18.063 2.884 -12.294"></a-entity>
      <a-entity id="blueTPSphere-14" mixin="tp_sphere" position="-18.02 2.884 22.737"></a-entity>
      <a-entity id="blueTPSphere-15" mixin="tp_sphere" position="-18.02 2.884 5.341"></a-entity>

      <!-- Walls -->
      <a-box id="wall-1" mixin="wall" width="15" height="5" depth="1" position="-0.215 2.5 10.025"></a-box>
      <a-box id="wall-2" mixin="wall" width="15" height="5" depth="1" position="-7.958 2.5 -9.76"></a-box>
      <a-box id="wall-3" mixin="wall" width="15" height="5" depth="1" position="3.731 2.5 -7.673" rotation="0 90 0" geometry="width:5">
      </a-box>
      </a-box>
      <a-box id="wall-4" mixin="wall" width="15" height="5" depth="1" position="-0.949 2.5 -7.671" rotation="0 90 0" geometry="width:5"></a-box>
      <a-box id="wall-5" mixin="wall" width="7" height="5" depth="1" position="-3.967 2.5 -5.568"></a-box>
      <a-box id="wall-6" mixin="wall" width="4" height="5" depth="1" position="5.234 2.5 -5.56"></a-box>
      <a-box id="wall-7" mixin="wall" width="7" height="5" depth="1" position="7.545 2.5 2.334" rotation="0 90 0" geometry="width:16"></a-box>
      <a-box id="wall-8" mixin="wall" width="7" height="5" depth="1" position="-7.263 2.5 1.945" rotation="0 90 0" geometry="width:16"></a-box>
      <a-box id="wall-9" mixin="wall" width="15" height="5" depth="1" position="10.757 2.5 -9.76"></a-box>
      <a-box id="wall-10" mixin="wall" width="15" height="5" depth="1" position="-11.465 2.5 -14.766" geometry="width:22"></a-box>
      <a-box id="wall-11" mixin="wall" width="15" height="5" depth="1" position="14.256 2.5 -14.766" geometry="width:22"></a-box>
      <a-box id="wall-12" mixin="wall" width="15" height="5" depth="1" position="-0.949 2.5 -21.78" rotation="0 90 0"></a-box>
      <a-box id="wall-13" mixin="wall" width="15" height="5" depth="1" position="3.731 2.5 -21.771" rotation="0 90 0"></a-box>
      <a-box id="wall-14" mixin="wall" width="15" height="5" depth="1" position="17.774 2.5 -2.704" rotation="0 90 0"></a-box>
      <a-box id="wall-15" mixin="wall" width="15" height="5" depth="1" position="17.774 2.5 12.273" rotation="0 90 0"></a-box>
      <a-box id="wall-16" mixin="wall" width="15" height="5" depth="1" position="1.307 2.5 19.273" geometry="width:33.5"></a-box>
      <a-box id="wall-17" mixin="wall" width="15" height="5" depth="1" position="-14.964 2.5 -2.746" rotation="0 90 0"></a-box>
      <a-box id="wall-18" mixin="wall" width="15" height="5" depth="1" position="-14.964 2.5 12.196" rotation="0 90 0"></a-box>
      <a-box id="wall-19" mixin="wall" width="15" height="5" depth="1" position="-35.967 2.5 19.308" geometry="width:30"></a-box>
      <a-box id="wall-20" mixin="wall" width="15" height="5" depth="1" position="-35.999 2.5 -9.72" geometry="width:30"></a-box>
      <a-box id="wall-21" mixin="wall" width="15" height="5" depth="1" position="-49.195 2.5 5.187" rotation="0 90 0" geometry="width:29"></a-box>
      <a-box id="wall-22" mixin="wall" width="15" height="5" depth="1" position="-21.464 2.5 11.458" rotation="0 90 0" geometry="width:30"></a-box>
      <a-box id="wall-23" mixin="wall" width="15" height="5" depth="1" position="1.307 2.5 25.688" geometry="width:46.5"></a-box>
      <a-box id="wall-24" mixin="wall" width="15" height="5" depth="1" position="24.156 2.5 7.806" rotation="0 90 0" geometry="width:36"></a-box>
      <!-- END WALLS -->

      <!-- Floor. -->
      <a-entity id="floor" shadow="receive: true" static-body geometry="depth:100;height:0.2;width:100;" material="repeat:50 20;color:#fafafa;metalness:0.2;roughness:1;src:https://ucarecdn.com/8a2780f7-e076-4f8c-bd1d-40ae172508a9/"></a-entity>

      <!-- World Sun -->
      <a-entity light="color:#CCC;intensity:0.6;type:ambient" position="0 11.345 0"></a-entity>

      <!-- Torches -->
      <a-entity id="torch-1" mixin="torch" position="-0.334 3.567 2.083">
        <a-entity mixin="torch_light"></a-entity>
      </a-entity>
      <a-entity id="torch-2" mixin="torch" position="1.392 3.567 -12.279">
        <a-entity mixin="torch_light"></a-entity>
      </a-entity>
      <a-entity id="torch-3" mixin="torch" position="-13.873 3.567 -12.279">
        <a-entity mixin="torch_light"></a-entity>
      </a-entity>
      <a-entity id="torch-4" mixin="torch" position="16.023 3.567 -12.279">
        <a-entity mixin="torch_light"></a-entity>
      </a-entity>
      <a-entity id="torch-5" mixin="torch" position="1.392 3.567 -27.163">
        <a-entity mixin="torch_light"></a-entity>
      </a-entity>
      <a-entity id="torch-6" mixin="torch" position="20.961 3.567 5.388">
        <a-entity mixin="torch_light"></a-entity>
      </a-entity>
      <a-entity id="torch-7" mixin="torch" position="20.961 3.567 22.432">
        <a-entity mixin="torch_light"></a-entity>
      </a-entity>
      <a-entity id="torch-8" mixin="torch" position="0.385 3.567 22.432">
        <a-entity mixin="torch_light"></a-entity>
      </a-entity>
      <a-entity id="torch-9" mixin="torch" position="-17.979 3.567 22.432">
        <a-entity mixin="torch_light"></a-entity>
      </a-entity>
      <a-entity id="torch-10" mixin="torch" position="-17.979 3.567 5.27">
        <a-entity mixin="torch_light"></a-entity>
      </a-entity>
      <!-- END TORCHES -->

    <!-- Camera. -->
    <a-entity camera id="player" player="health: 200" sound="src:#bg_music; autoplay:true; loop:true; volume:0.05" userHeight="1.6" universal-controls kinematic-body="radius:0.8" position="1.464 1.572 2.571">

    	<a-entity id="player-head" geometry="primitive:sphere;radius:0.2" material="color:red;roughness:1"></a-entity>

      	<!-- HP Interface -->
      	<a-entity position="-0.553 -0.328 -0.725" material="color:red" geometry="primitive:plane;height:3;width:7" text="align:center;color:#322342;value:HP;width:50" id="text-health-player" scale="0.05 0.05 0.05" rotation="0 35 0"></a-entity>

    	<!-- Cursor -->
     	<a-entity cursor position="0 0 -0.5" geometry="primitive:ring;radiusInner:0.01;radiusOuter:0.016" material="opacity:0.5;shader:flat;transparent:true;color:#ff9" scale="0.8 0.8 0.8" raycaster ></a-entity>

        <!-- Player Sword-->
      	<a-entity id="player-sword" position="0.416 -0.957 -0.463" shadow="cast: true" obj-model="mtl:#player-sword-mtl;obj:#player-sword-obj" id="player-sword" scale="0.05 0.05 0.05" rotation="0 90 -5" material="">
          
          	<!-- Sword Hit Rotation Animation -->
        	<a-animation id="p-sword-rotation" attribute="rotation" to="0 90 -80" direction="alternate" repeat="1" begin="player-attack" easing="linear" dur="200"></a-animation>
      	</a-entity>

        <!-- Player Shield -->
      <a-entity position="-0.705 -1.703 -0.411" shadow="cast: true" scale="0.1 0.1 0.1" id="player-shield" obj-model="mtl:#player-shield-mtl;obj:#player-shield-obj" rotation="0 -90 0" material=""></a-entity>

    </a-entity>

      <!-- Sky -->
      <a-sky color="#3c3c3c"></a-sky>

      <!-- Shop -->
      <a-entity position="-3.122 0 7.714" rotation="0 180 0" scale="0.1 0.1 0.1" id="shop" obj-model="mtl:#shop-mtl;obj:#shop-obj" material="">

        <!-- Shop's Bounding Box -->
        <a-entity position="4.546 13.658 -2.34" static-body="sphereRadius:NaN" geometry="depth:32;height:25;width:63" visible="false"></a-entity>
      </a-entity>

      <!-- Shop man head -->
      <a-entity position="-3.687 1.811 7.573" look-at="#player">
        <a-entity position="-0.55 -1.854 -0.123" rotation="0 0 0" scale="0.1 0.1 0.1" obj-model="mtl:#shop-head-mtl;obj:#shop-head-obj"></a-entity>
        <a-entity position="0.016 1.071 0.071" material="color:lightgrey;height:10;width:10;wireframeLinewidth:1" geometry="primitive:plane;height:0.25;width:1.6" text="align:center;color:#322342;tabSize:1;value:Do you need something?;wrapCount:30" id="inventory-6"></a-entity>
      </a-entity>

      <!-- Enemies -->
      <a-entity shadow="cast: true" sound="src:#fx_punch; poolSize:5" position="1.351 0 0" scale="0.1 0.1 0.1" id="Ghost01" static-body="shape: box" enemy="health: 30; id: 1" obj-model="obj:resources/ghost.obj" material="src:#ghost_img">

	    <!-- Bounding Box -->
	    <a-box width="15" height="5" depth="3" position="0 0 0" static-body visible="false"></a-box>

	    <!-- Punch Sound -->
        <a-entity sound="src:#fx_punch"></a-entity>

      	<!-- Animation -->
      	<a-animation attribute="position" to="1.351 0.1 0" direction="alternate-reverse" repeat="indefinite" easing="linear" dur="1000"></a-animation>

	    <!-- UI -->
	    <a-entity position="2 10 10" id="1-ui">
	    	<a-entity position="0 10 0" material="color: red" geometry="primitive:plane; width: 7; height: 3;" text="align:center;value:HP;width:50;color:#322342" id="text-health-1"></a-entity>

	    	<a-entity position="-10 -2 0" material="color: lightgrey" geometry="primitive:plane; width: 7; height: 3;" attack-button="targetEntity: #Ghost01" text="align:center;value:Attack;width:50;color:#322342" id="text-attack-1"></a-entity>

	      	<a-entity position="0 -2 0" material="color: lightgrey" geometry="primitive:plane; width: 7; height: 3;" text="align:center;value:Defend;width:50;color:#322342" id="text-defend-1"></a-entity>

	     	<a-entity position="10 -2 0" material="color: lightgrey" geometry="primitive:plane; width: 7; height: 3;" text="align:center;value:Evade;width:50;color:#322342" id="text-evade-1"></a-entity>
	    </a-entity>
	  </a-entity>
    </a-scene>